<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prediction Result | AgriSense</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --stem: 80 40% 25%;
      --wheat-gold-1: #e2c275;
      --wheat-gold-2: #c9a646;
      --wind: 1;
    }

    body{margin:0;overflow-x:hidden;position:relative;min-height:100vh;}

    /* Background Scene */
    .scene{
      position:fixed;
      inset:0;
      z-index:-1;
      pointer-events:none;
      background:transparent;
      overflow:hidden;
    }
    /* Add this under .scene */
.scene::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(to top, rgba(253, 250, 246, 1) 0%, rgba(253, 250, 246, 0) 40%);
  pointer-events: none;
}

    .layer{position:absolute;inset:0;bottom:0;}

    .blade{
      position:absolute;bottom:0;width:3px;height:140px;
      transform-origin:50% 100%;
      background:linear-gradient(180deg,hsl(var(--stem)/1),#5a7a42);
      border-radius:3px;
      animation:sway ease-in-out infinite;
      animation-duration:calc(4s/var(--spd));
      animation-delay:var(--delay);
      --spd:1;--amp:1;
    }
    .blade::after{
      content:"";position:absolute;bottom:55%;left:50%;transform:translateX(-50%);
      width:10px;height:12px;border-radius:50%;
      background:radial-gradient(circle at 40% 20%,var(--wheat-gold-1),var(--wheat-gold-2));
      box-shadow:
        0 -10px 0 0 var(--wheat-gold-2),
        0 -20px 0 0 var(--wheat-gold-1),
        0 -30px 0 0 var(--wheat-gold-2),
        0 -40px 0 0 var(--wheat-gold-1),
        0 -50px 0 0 var(--wheat-gold-2);
    }

    @keyframes sway{
      0%{transform:rotate(calc(-4deg*var(--wind)*var(--amp)));}
      50%{transform:rotate(calc(6deg*var(--wind)*var(--amp)));}
      100%{transform:rotate(calc(-4deg*var(--wind)*var(--amp)));}
    }

    .far .blade{
      opacity:0.6;
      filter:blur(1px);
      transform:scaleY(0.9);
    }
  </style>
</head>
<body class="bg-[#fdfaf6] font-sans text-gray-800">

  <!-- Background Wheat Animation -->
  <div class="scene">
    <div class="layer far" id="far"></div>
    <div class="layer" id="mid"></div>
  </div>

  <!-- Container -->
  <div class="max-w-5xl mx-auto px-6 py-12 relative z-10">

    <!-- Header -->
    <div class="text-center mb-10">
      <h1 class="text-3xl md:text-4xl font-bold text-green-700">üå± Prediction Result</h1>
      <p class="text-gray-600 mt-2">Here are your recommended crop & price forecasts for the next 6 months</p>
    </div>

    <!-- Crop + Location -->
    <div class="grid md:grid-cols-2 gap-6 mb-10">
      <div class="bg-white shadow-lg rounded-2xl p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-2">Recommended Crop</h2>
        <p class="text-2xl font-bold text-green-700">{{ crop }}</p>
      </div>
      <div class="bg-white shadow-lg rounded-2xl p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-2">Location</h2>
        <p class="text-lg font-medium text-gray-800">{{ state }}, {{ district }}, {{ market }}</p>
      </div>
    </div>

    <!-- R¬≤ Score -->
    <div class="bg-green-50 border border-green-200 rounded-2xl p-6 text-center mb-10">
      <p class="text-lg text-gray-700 font-semibold">Model Accuracy (R¬≤ Score)</p>
      <p class="text-3xl font-bold text-green-700 mt-2">{{ r2_score }}</p>
    </div>

    <!-- Predicted Prices -->
    <div class="bg-white shadow-lg rounded-2xl p-6 mb-10">
      <h2 class="text-xl font-bold text-green-700 mb-4">üìà Next 6 Months Predicted Prices (‚Çπ/quintal)</h2>
      <ul class="space-y-2">
        {% for month, price in predicted_prices.items() %}
        <li class="flex justify-between border-b pb-2">
          <span class="font-medium text-gray-700">{{ month }}</span>
          <span class="font-semibold text-green-700">‚Çπ {{ price }}</span>
        </li>
        {% endfor %}
      </ul>
    </div>

    <!-- Max Price -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-2xl p-6 text-center mb-10">
      <p class="text-lg text-gray-700 font-semibold">Best Month for Selling</p>
      <p class="text-xl font-bold text-yellow-700 mt-2">{{ max_month }} ‚Üí ‚Çπ {{ max_price }}</p>
    </div>

    <!-- Graph -->
    <div class="bg-white shadow-lg rounded-2xl p-6 mb-10 text-center">
      <h2 class="text-xl font-bold text-green-700 mb-4">üìä Price Trend Graph</h2>
      <img src="{{ plot_file }}" alt="Price Trend Graph" class="mx-auto rounded-lg shadow-md">
    </div>

    <!-- Back Button -->
    <div class="text-center">
      <a href="/" class="px-6 py-3 bg-green-600 text-white font-semibold rounded-xl shadow hover:bg-green-700 transition">‚Üê Go Back</a>
    </div>
  </div>

  <script>
    const rand=(a,b)=>a+Math.random()*(b-a);
    function makeWheat(container,count,scale=1){
      const frag=document.createDocumentFragment();
      for(let i=0;i<count;i++){
        const b=document.createElement('div');
        b.className='blade';
        const x=rand(0,100);
        const h=rand(100,160)*scale;
        const spd=rand(.8,1.2);
        const amp=rand(.8,1.2);
        const delay=`${rand(-3,0).toFixed(2)}s`;
        b.style.left=`${x}%`;
        b.style.height=`${h}px`;
        b.style.setProperty('--spd',spd.toFixed(2));
        b.style.setProperty('--amp',amp.toFixed(2));
        b.style.setProperty('--delay',delay);
        b.style.opacity=rand(0.85,1).toFixed(2);
        frag.appendChild(b);
      }
      container.appendChild(frag);
    }
    makeWheat(document.getElementById('far'),150,0.9);
    makeWheat(document.getElementById('mid'),120,1);
  </script>
</body>
</html>
